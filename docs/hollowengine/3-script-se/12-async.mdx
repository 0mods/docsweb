---
sidebar_position: 12

title: ♊ Асинхронные действия
id: async
description: Я хочу и то и другое, в - одно и то же время!
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import styles from '../.resources/styles.module.css';

:::note Действия в несколько потоков

<Tabs>
  <TabItem value="baseAsync" label="Простой async" attributes={{className: styles.def}}>

  > Появляется возможность выполнять несколько действий в 1 момент.
  > Можно ставить друг за другом или внутри 1-го ещё марочку.
  ```kts
  // Данные действия будут работать в другом потоке
  async{
      ...
  }
  ```
  </TabItem>
  <TabItem value="funcAsync" label="Функциональный async" attributes={{className: styles.def}}>

  ```kts
  // Так жы вы можете сделать async как переменные
  val <id> = async{
  ...
  }
  ```
  > Как работает:
  > - Вы создаёте переменную async и присваиваете ей имя.
  > - Через имя вы можете:
  >   - Останавливать async -> `<id>.stop()`
  >   - Продолжать работу async -> `<id>.resume()`
  > ```kts
  > <id>.stop() // Останавливает работу async с именем: id
  > <id>.resume() // Продолжает работу async с именем: id, после остановки
  > ```
  </TabItem>
  <TabItem value="howAsyncWork" label="Как работает async{} в целом?" attributes={{className: styles.def}}>

    > `async` (или же **Асинхрон**) - Запускает часть скрипта, которая находится в его скабках `{}` в ***другом потоке***.
    > - Т.е. - Весь скрипт работает поочерёдно (каждое действие идёт друг за другом и ждёт, пока предыдущее действие не закончится). Если нам нужно чтобы 2 части в скрипте работали вместе (одновременно), то мы может использовать метод `async`.
    > - Чисто условно - скрипт продолжает свою работу, но на моменте с `async` он делится как бы - на:
    >   - ***Основную*** - где всё что не вошло в метод, работает так же как и обычно,
    >   - ***Асинхронную*** - Всё что вошло в метод), в которых содержаться каждая своя часть.
    > ----
    > Схема работы (примерная):
    > ```mermaid
    > graph TD;
    >   Start[Начало скрипта]; End[Конец скрипта];
    >   ASYNC_START["async{..."]; ASYNC_END["...}"];
    >   BASIC[Основной поток]; ASYNC[Другой поток]
    >   
    >   Start-->ASYNC_START;
    >   ASYNC_START-->|"Всё что находится после \n`async{...}` - Выполняется параллельно с async"|BASIC;
    >   BASIC-->ASYNC_END;
    >   
    >   ASYNC_START-->|"Всё что написано в {...} \nВыполняется в [ДРУГОМ ПОТОКЕ]"|ASYNC;
    >   ASYNC-->ASYNC_END;
    >   
    >   ASYNC_END-->|"Как только дейсвия в `async{...}` заканчиваются \nДвижок автоматически приостанавливает работу async"|End;
    > ```
  
  Пример **правильного использования метода**:
  ```kts
  async{
    npc say{"Привет Андрей!"}    
  }
  npc playOnce{"hello"}
  ```
  > НИП как только скажет "Привет" - тут же выполнит действие `Воспроизвести анимацию 'hello'`
  
  </TabItem>
</Tabs>

:::

---

## Примеры
:::info -
```kts
async{ // Запустить простой async
    npc moveAlwaysTo{...}
    ...
}
// или же
val looks = async{ // Привязать async к переменной и запустить
    npc lookAlwaysAt{...}
    ...
}
...

look.stop() // Остановить работу привязанного async
...
look.resume() // Восстановить работу привязанного async
```
:::